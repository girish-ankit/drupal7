<?php
// $Id$
/**
*@file
* This file is created to show custom pager creation in drupal.
* 
*/




/**
 
 * Implementation of hook_views_pre_execute()
 
 *
 
 **/
 
function view_query_log_views_pre_execute(&$view) {
 //print_r($view); die();
 $userIp = ip_address();
 print $userIp; die();
  $IP = "127.0.0.1";
  $IPL = "210.7.64.98";
 if($userIp == $IP)
{
 $viewMachineName = $view->name;
 $viewHumanName = $view->human_name;
 $viewDelta = $view->current_display;
 $viewQuery = $view->build_info['query'];
 $ViewRunTime = date('d/m/Y : H i s', time());
 $viewPath = current_path();
 

 $nid = db_insert('view_query_log') // Table name no longer needs {}
->fields(array(
  'view_m_name' => $viewMachineName,
  'view_h_name' => $viewHumanName,
  'view_delta' => $viewDelta,
  'view_query_data' => $viewQuery,
  'view_run_time' => $ViewRunTime,
  'view_run_path' => $viewPath,
  'view_run_path' => $viewPath,
  'view_user_ip' => $userIp,
))->execute();
 
// drupal_set_message($view->name. 'inserted to database');
}
}
